
create table ipasnieki (
ID number(5,0) not null constraint ipasn_pk primary key, 
Pers_kods varchar2(12) not null,
vards varchar2(50) not null,
Uzvards varchar2(50)not null);

CREATE SEQUENCE seq_ipasn
MINVALUE 1
START WITH 1
INCREMENT BY 1
CACHE 10;

insert into ipasnieki values (seq_ipasn.nextval,'071191-34265','Kārlis','Berziņš');
insert into ipasnieki values (seq_ipasn.nextval,'020591-34265','Ance','Kalniņa');



create or replace package add_ipasn
is
  procedure new_ipasn(pers_k1 varchar2, pers_k2 varchar2, vards varchar2,
                        uzvards varchar);
end;
/

create or replace package body add_ipasn
is
    kluda number(1);
    
  procedure new_ipasn(pers_k1 varchar2, pers_k2 varchar2, vards varchar2, 
                        uzvards varchar)
  is
  begin
    
    kluda := 0;
  
    if (length(pers_k1) <> 6) then
        dbms_output.put_line('kļūda pers kodā 1');
        kluda := 1;
    elsif (length(pers_k2) <> 5) then
        dbms_output.put_line('kļūda pers kodā 2');
        kluda := 1;
    else
         dbms_output.put_line(pers_k1 || '-' || pers_k2);
    end if;
    dbms_output.put_line(length(pers_k2));
    
    if REGEXP_LIKE(pers_k1, '^[[:digit:]]+$') then
        dbms_output.put_line('nav kļūda pers kodā 1');
    else
         dbms_output.put_line('ir kļūda pers kodā 1');
         kluda := 1;
    end if;
    
    if REGEXP_LIKE(pers_k2, '^[[:digit:]]+$') then
        dbms_output.put_line('nav kļūda pers kodā 2');
    else
         dbms_output.put_line('ir kļūda pers kodā 2');
         kluda := 1;
    end if;
    
    if REGEXP_LIKE(vards, '[[:alpha:]]+$') then
        dbms_output.put_line('nav kļūda vardā');
    else
         dbms_output.put_line('ir kļūda vardā');
         kluda := 1;
    end if;
    if REGEXP_LIKE(uzvards, '[[:alpha:]]+$') then
        dbms_output.put_line('nav kļūda vardā');
    else
         dbms_output.put_line('ir kļūda vardā');
         kluda := 1;
    end if;
    
    if kluda = 1 then
        dbms_output.put_line('ipasnieka pievienosana neveiksmīga');
    else
    insert into ipasnieki values (seq_ipasn.nextval,pers_k1 || '-' || pers_k2,
                                   vards,uzvards);
        dbms_output.put_line('ipasnieka pievienosana veiksmīga');
    end if;

 
  end new_ipasn;
begin
  NULL;
end;
/

exec add_ipasn.new_ipasn('110999','15325','Agnese','kļaviņa');

select * from ipasnieki;
